#2_курс #Data_Science 

---
# ОГЛАВЛЕНИЕ

```table-of-contents
```
---

# Подготовка данных по CRISP-DM

## I.  Восстановление пропущенных значений

- **Исключить объекты с пропусками** --> нарушим закономерность, всё испортим
- **Заменить пропущенное значение константой** --> поменяет значение
- **Предсказать пропущенное значение на основании других переменных**
- **Заменить пропущенное значение средним или медианой значения по всему столбику**
- **Моделировать пропущенное значение с помощью регрессии или с помощью вероятностных функций или другими способами**
- **Другие способы**

> [! EXAMPLE]
> В таблице могут быть незаполненные ячейки, или же содержимое некоторых ячеек заведомо некорректное и противоречит здравому смыслу:
>
> | ФИО | Пол | Рост | Вес | Место на олимпиаде |
> | --- | --- | --- | --- | --- |
> | Иванов | 1 | 172 | 107 | 3 |
> | Петренко | ? | 185 | 64 | -4 |
> | Сидорова | 0 | 168 | 665 | 2 |
> | Николаева | 0 | ? | 85 | 1 |

#### Что можно сделать

- Удалить объект (строку);
- Удалить столбец, если в нем очень много пропусков;
- Заменить значение в ячейке на среднее/медиану/моду/... из значений столбца: например, для столбца-признака (0, 1, 2, 4, 4, 5, ?) пропущенное значение можно заменить на среднее (2,67), медиану (3), моду (4).

#### Что делать с номинальными признаками

Если признак «пол человека» (0, 0, 0, 1, 1, ?), то мы можем:
- Заменить на моду (т. е. на 0);
- Сгенерировать 0 с вероятностью $3/5$ или 1 с вероятностью $2/5$;
- Волевым решением объявить «пол» числовым признаком (со всеми вытекающими отсюда последствиями), и применить к нему методы восстановления для числовых признаков.

## II. Метрика

#### Восстановление данных при помощи метрики

1. $\rho(P, P) = 0$ (в принципе, логично)
2. $\rho(P, Q) = \rho(Q, P)$ (разумно)
3. $\rho(P, Q) \leq \rho(P, T) + \rho(T, Q)$ (неравенство треугольника)

Метрика:
1. Может быть вычислена для объектов произвольной природы;
2. Формул много, можно придумать свою, главное – должна отвечать требованиям;

#### Известные метрики

> Если даны два набора
> $$
P = (p_1,p_2,\space...\space,p_n),\space Q=(q_1,q_2,\space...\space,q_n)
> $$
> то расстояние между $P$ и $Q$ можно найти следующими способами:

1. **Евклидова метрика (как в учебнике по геометрии)**
$$
\rho(P,Q) = \sqrt{(p_1-q_1)^2+(p_2-q_2)^2+\space...\space+(p_n-q_n)^2}
$$

2. **Метрика Манхеттен**
$$
\rho(P, Q) = |p_1-q_1|+|p_2-q_2|+\space...\space+|p_n-q_n|
$$

3. **max-метрика**
$$
\rho(P, Q) = \max(|p_1 - q_1|,\space|p_2 - q_2|,\space...\space,\space|p_n-q_n|)
$$

#### Пример

> [! EXAMPLE]
> Пусть у объекта A значение признака P не корректно. Как восстановить P для A?

![[Pasted image 20240327220625.png]]
![[Pasted image 20240327220658.png]]
![[Pasted image 20240327220713.png]]


#### Формула для восстановления данных с помощью метрики

$$

^991e69

P(A) = \frac{1}{\sum_{i=1}^{n} \frac{1}{\rho(A, A_i)}}(\sum_{j=1}^{n}\frac{P(A_j)}{\rho(A, A_j)}) ^72dcb6
$$

> [! ATTENTION]
> Для адекватной работы необходимо, чтобы все признаки (значение по осям) имели одинаковый масштаб.


#### Замечание об использования метрики

> [! ATTENTION]
> Некоторые признаки фактически будут проигнорированы. В следующем примере различия в росте и различия в весе имеют **очень** разную ценность – это из-за разных единиц измерения:
> 
> | Студент  | Вес | Рост |
> | -------- | --- | ---- |
> | Иванов   | 61  | 1,76 |
> | Сидорова | 56  | 1,50 |
> | Петров   | 100 | 1,98 |

При вычислении метрики все признаки приводить к единой шкале, т.е. нормировать:
1. Выполнить преобразование:
$$
p^`_i = \frac{p_i - \overline p}{s}
$$

>После этого у признака $Р$ среднее значение и отклонение будут разны 0 и 1 соответственно;

2. К признакам можно предварительно применять разные функции, например, логарифм.


#### Восстановление с помощью других столбцов (использование корреляции)

Признак с большим (по модулю) КК имеет большее влияние на величину пропущенного признака.

> Пусть $P(A)$ – значение признака $P$ по объекту $A$. $P$ - среднее значение признака $P$. требуется определить $P(A)$ по столбцам-признакам $p_1,p_2,\space...\space,Pm$:
> $$ P(A) = dddd $$

#### Восстановление с помощью моделей предсказания


**Идея:** если мы сумеем научить предсказывать значение признака $P$, используя для этого все другие признаки, то автоматически будет решена проблема восстановления данных для признака $P$.

> [!example]
> В этой таблице восстановление данных эквивалентно предсказанию места на олимпиаде по остальным данным студента.
> 
> | Студент    | Пол | Рост | Вес | Место на олимпиаде |
> | ---------- | --- | ---- | --- | ------------------ |
> | Иванов     | 1   | 172  | 107 | ?                  |
> | Запеканка  | 1   | 185  | 64  | ?                  |
> | Вартушкина | 0   | 168  | 61  | ?                  |
> | Ололоева   | 0   | 201  | 85  | ?                  |
> ==(это реальные фамилии со слайда)==

---
## III. Обогащение данных

> [!NOTE]
> ***Обогащение данных*** – процесс насыщения данных новой информацией, которая позволяет сделать их более ценными и значимыми с точки зрения той или иной аналитической задачи (например, данные о доходах сотрудников дополнить средними значениями по региону, профессии).

Внешнее обогащение предполагает привлечение дополнительной информации из внешних источников (статистические сайты, сайт мирового банка, правительственные https://data.gov.ru).

Внутреннее обогащение предполагает повышение информативности и значимости данных за счет изменения и реорганизации (были $s$ и $h$, добавили объем $v$).

---

## IV. Преобразование (трансформация) данных

> [!NOTE]
> Комплекс методов и алгоритмов, направленных на оптимизацию представления и форматов данных с точки зрения решаемых задач и целей анализа.

**Цель трансформации данных** — представить информацию в таком виде, чтобы она могла быть использована более эффективно.

>[!NOTE]
>***Кластерный анализ*** — отдельный вид анализа, который делит объекты на группы по сходным значениям переменных. В рамках сходства они могут быть несравнимы ... (миллиметры, копейки).

#### Методы предобразования данных

- Преобразование упорядоченных данных
- Квантование (новые интервалы, на основе их кодирование)
- Сортировка
- Слияние
- Группировка и разгруппировка
- Настройка набора данных
- Табличная подстановка значений
	- Преобразование в уникальные числовые коды
	- Двоичное кодирование
	- Кодирование с помощью дополнительной информации
- Вычисляемые (производные) значения
- Нормализация

### Квантование

> [!NOTE]
> ***Квантование*** – это процедура преобразования данных, состоящая из двух шагов:
>
>1. Диапазон значений переменной разбивается на заданное число интервалов, каждому из которых присваивается некоторый номер (уровень квантования);
>2. Каждое значение заменяется номерном интервала квантования.
>
> ***Равномерное квантование*** – преобразование, при котором диапазон значений разбивается на интервалы равной длины. Имеет смысл, если значения распределены равномерно по всему диапазону значений.
> 
> ***Неравномерное квантование*** – преобразование, при котором диапазон значений разбивается на интервалы различной длины (ассиметричные). Имеет смысл, если в значениях нет пропусков и сгустков.

### Нормализация

>[!NOTE]
>В случае машинного обучения, ***нормализация*** — это процедура предобработки входной информации (выборок и реальных данных), при которой значения признаков во входном векторе приводятся к некоторому заданному диапазону, например, $[0..1]$ или $[-1..1]$.

Необходимость нормализации выборок данных обусловлена природой используемых алгоритмов и моделей Machine Learning. Исходные значения могут изменяться в очень большом диапазоне и отличаться друг от друга на несколько порядков. Это делает работу алгоритмов некорректной.

**Виды:**
- Десятичное преобразование:
$$
V^`_i = \frac{V_i}{10^k},\space\max(V^`_i) < 1
$$

- Максимальное преобразование:
$$
V^`_i = \frac{V_i - \min_i(V_i)}{\max_i(V_i) - \min_i(V_i)}
$$

- Нормализация с помощью стандартного преобразования:
$$
V^`_i = \frac{V_i - \overline V}{\sigma_V}
$$
где $\overline V$ – выборочное среднее, $\sigma_V$ – среднее квадратическое отклонение

- Нормализация с помощью преобразований.

---
## V. Описание данных

Частотная гистограмма показывает, сколько раз в переменной встретилось то или иное значение. Может быть сделана по любым исходным данным. По ней мы можем понять, можно ли использовать классические статистики. Если наша частотная гистограмма показывает, что данные слишком несимметрично распределены, то средние могут быть либо завышены, либо занижены. Мультимодальные распределения: по факту это смесь распределений и для того, чтобы анализировать переменную, ее требуется разделить на группы, которые и определяют эти пики.

#### Статистика

> ***Цель описательной статистики*** – обработка эмпирических данных, их систематизация, наглядное представление в виде графиков и таблиц, а также их количественное описание посредством основных статистических показателей.

---
## VI. Выбросы

> [!NOTE]
> ***Выброс (outlier)*** – 1) аномально маленькие или аномально большие значения по сравнению с остальными значениями выборки, оно появляется случайно, одно из возможных значений; 2) ==экстремальные значения во входных данных, которые находятся далеко за пределами других наблюдений== (например, все предметы на кухне имеют температуру около 22-25 градусов Цельсия, а духовка – 220).

#### Виды выбросов

На основе ***размерности*** изучаемого массива данных:
1. **Одномерные выбросы** – точка является выбросом только по одной из своих координат;
2. **Многомерные выбросы** – точка является выбросом сразу по нескольким координатам.

По ***окружению***:
1. **Точечные выбросы** – единичные точки, выбивающиеся из общей картины. Часто используются в системах контроля транзакций для выявления мошенничества, например, когда с украденной карты совершается крупная покупка;
2. **Контекстуальные выбросы** – для того, чтобы определить, является ли точка выбросом, необходим контекст, например, в Петербурге +15 градусов Цельсия. Зимой такая температура является выбросом, а летом – нет;
3. **Коллективные выбросы** – выбросом является группа точек, например, задержки поставок на фабрике.

#### Причины возникновения выбросов

- Сбой работы оборудования;
- Человеческий фактор;
- Случайность;
- Уникальные явления и другое.

#### Обнаружение выбросов

**Экстремальный анализ данных (англ. *extreme value analysis*):** При таком анализе не применяются какие-либо специальные статистические методы.
Обычно этот метод применим для одномерного случая.

**Алгоритм:**
1. Визуализировать данные с помощью гистограмм и диаграмм для нахождения экстремальных значений;
2. Задействовать распределение, например Гауссовское, и найти значения, чьё ***стандартное отклонение*** отличается в 2-3 раза от математического ожидания или в полтора раза от первой либо третьей квартилей;
3. Отфильтровать предполагаемые выбросы из обучающей выборки и оценить работу модели.

![[Pasted image 20240327222037.png]]


---

# Основные понятия машинного обучения

> [!NOTE]
> **Регрессия** – задача на предсказание вещественного числа
> 
> ***Классификация*** – или определение класса объекта. Два класса – котята и собака. Мы можем показать огромное количество котят и собак, его задача – определить, где и кто изображён. **Это и будет классификацией.**
> 
> ***Кластеризация*** – задача изучения окружающего мира, среды, чтобы мы могли более эффективно действовать дальше.
> ==**Пример:**== взять набор объектов и выявить его структуру. Найти конкретные группы – кластеры, которые наиболее похожи внутри группы, но сильно различаются по группам. Чем полезно – когда у нас огромное количество данных, мы о них ничего не знаем и нам нужно понять из чего эти данные состоят. Например, потребители, посетители больницы.

---

## Классификация

> [!NOTE]
> ***Классификация*** – или определение класса объекта. Два класса – котята и собака. Мы можем показать огромное количество котят и собак, его задача – определить, где и кто изображён. **Это и будет классификацией.**

**Задача классификации** – формализованная задача, в которой имеется множество объектов, разделённых некоторым образом на классы. Задано конечное множество объектов, для которых известно, к каким классам они относятся. Классовая принадлежность других объектов неизвестна. Требуется построить алгоритм, способный классифицировать неизвестные объекты.

### ==Пример== «Кредитный скоринг»:

>[!example]
>Необходимо определить:
>1. «Дать ли кредит?»
>2. «На какую сумму?»
>3. «По какой процентной ставке?»
>
>Для этого может использоваться вот такой набор данных, распределение доходов, вплоть до транзакций по кредитной карте, площадь квартиры, наличие загранпаспорта Следующая характеристика — именно конечное число классов.
>
> | Пол                                   | женский |
> | ------------------------------------- | ------- |
> | **Семейный статус**                   | замужем |
> | **Дети**                              | 2       |
> | **Заработная плата**                  | 80000   |
> | **Долг по кредитной карте**           | 10000   |
> | **Доля расходов на продукты питания** | 30%     |

### ==Пример== «Титаник»:

>[!EXAMPLE]
> Мы знаем, кто спасся, а кто, к сожалению, не смог спастись, знаем признаки людей – они сведены в таблицу:
> 
> | Класс каюты                                          | 1, 2 или 3  |
> | ---------------------------------------------------- | ----------- |
> | **Пол**                                              | м/ж         |
> | **Возраст**                                          | кол-во лет  |
> | **Количество братьев, сестёр или супругов на борту** | кол-во      |
> | **Количество детей или родителей на борту**          | кол-во      |
> | **Номер билета**                                     | #           |
> | **Тариф**                                            | #           |
> | **Номер каюты**                                      | #           |
> | **Порт назначения**                                  | Шербур, ... |
> 
> Класс человека – выжил или нет.
> Наша задача — найти конкретный алгоритм, который максимально точно будет определять это значение. Дополнительной задачей было бы выяснить, какие факторы были ключевыми для выживания. Мы хотим узнать вес этих факторов.
> Но это вторично. Основное – предсказать, выжил человек или нет.
> Как? Например, мы можем использовать деревья решений.

#### Ключевые характеристики задачи классификации

Как и в задаче регрессии, у нас есть признаки. Это могут быть:
- площадь квартиры;
- рост человека;
- наличие загранпаспорта и т. д.

У нас есть конечное количество классов. Например:
- Тип жилья: эконом-класс, средний класс, бизнес-класс, люкс;
- Уровень образования: нет образования, среднее, средне-специальное, высшее, ученая степень;
- Вернет ли человек кредит: да или нет (бинарная классификация).

#### Дерево решений

Дерево решений – является ли задача задачей классификации:

![[Pasted image 20240327224709.png]]

Дерево решений – выжил ли пассажир при кораблекрушении:
Берем какой-то фактор, например энтропию (мера неопределенности), и максимально её уменьшаем.

![[Pasted image 20240327224859.png]]

### Итог

1. Классификация – задача на определение класса объекта;
2. Классов конечное количество;
3. Ответ да/нет - тоже классификация (бинарная).

---
### Кластеризация

> ***Кластеризация*** – 1) задача изучения окружающего мира, среды, чтобы мы могли более эффективно действовать дальше, 2) задача разбиения некоторого количества объектов на такие группы, что объекты внутри группы были максимально схожи, а объекты из разных групп максимально отличались. Это задача о том, чтобы взять набор данных, о котором нет информации, и выявить его структуру, выделить группы, которые есть в этом наборе.

> [!EXAMPLE]
> ==**Пример:**== взять набор объектов и выявить его структуру. Найти конкретные группы – кластеры, которые наиболее похожи внутри группы, но сильно различаются по группам. Чем полезно – когда у нас огромное количество данных, мы о них ничего не знаем и нам нужно понять из чего эти данные состоят. Например, потребители, посетители больницы.

Зачем это может быть нужно:
- Сегментация покупателей;
- Анализ социальных сетей;
- Разбор фотографий на темы.

> Выделение структуры данных в любом наборе – шаг, предшествующий классификации.